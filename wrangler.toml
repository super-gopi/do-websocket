name = "user-websocket"
main = "src/index.ts"
compatibility_date = "2024-09-02"
compatibility_flags = ["nodejs_compat"]

# Define the User-scoped WebSocket Bridge Durable Object
[[durable_objects.bindings]]
name = "USER_WEBSOCKET"
class_name = "UserWebSocket"

# Define the Broadcaster Durable Object
[[durable_objects.bindings]]
name = "BROADCASTER"
class_name = "Broadcaster"

# Migration for the Durable Objects
[[migrations]]
tag = "v1"
new_sqlite_classes = ["UserWebSocket"]

[[migrations]]
tag = "v2"
new_sqlite_classes = ["Broadcaster"]

[observability.logs]
enabled = true

# Optional: Environment variables
# [vars]
# ENVIRONMENT = "production"

# Optional: KV namespaces (if you need them later)
# [[kv_namespaces]]
# binding = "MY_KV"
# id = "your-kv-namespace-id"

# Optional: R2 buckets (if you need them later)
# [[r2_buckets]]
# binding = "MY_BUCKET"
# bucket_name = "your-bucket-name"